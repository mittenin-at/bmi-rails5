<% content_for :script do %>
  <%= javascript_include_tag "prototype", "effects", "application", "jquery-1.6.min", "highcharts", "modules/exporting", "themes/grid" %>
  <script type="text/javascript" src="/javascripts/themes/gray.js"></script>
  <script type="text/javascript">
    jQuery.noConflict();
  </script>
<% end %>

<div class="block">
  <div class="secondary-navigation">
    <ul class="wat-cf">
      <li class="first"><%= link_to "#{t("web-app-theme.list", :default => "List")}", weighings_path  %></li>
      <li><%= link_to "#{t("web-app-theme.new", :default => "New")}", new_weighing_path %></li>
      <li class="active"><%= link_to "#{t("web-app-theme.diagram")}", diagram_weighings_path %></li>
    </ul>
  </div>
  <div class="content">
    <div class="inner">
        <p>

<script type="text/javascript" charset="utf-8">
  jQuery(document).ready(function() {
    Highcharts.setOptions({ lang: { months: ['Jänner', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],
                               		  weekdays: ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnertag', 'Freitag', 'Samstag'] } });
    chart= new Highcharts.Chart({
      chart: { renderTo: 'diagram', defaultSeriesType: 'spline' },
      title: { text: 'Gewichtsverlauf' },
      xAxis: { type: 'datetime' },
      yAxis: {
         title: { text: 'Gewicht (kg)' },
         min: 0,
         minorGridLineWidth: 0,
         gridLineWidth: 0,
         alternateGridColor: null
      },
      tooltip: { formatter: function() { return ''+ Highcharts.dateFormat('%e. %b %Y, %H:00', this.x) +': '+ this.y +' kg'; } },
      plotOptions: {
         spline: {
            lineWidth: 4,
            states: { hover: { lineWidth: 5 } },
            marker: {
               enabled: false,
               states: { hover: { enabled: true, symbol: 'circle', radius: 5, lineWidth: 1 }}
            },
         }
      },
      series: [{
         name: 'Name',
         data: [
         <% @weighings.each do |weighing| %>
         [ Date.UTC(<%= weighing.date.year %>, <%= weighing.date.month %>, <%= weighing.date.day %>), <%= weighing.weight %>],
         <% end %>
         ]
      }],
      navigation: { menuItemStyle: { fontSize: '10px' } }
   });
});
</script>
<span id="diagram" class="highcharts-container" style="display:inline; width:1000px; height:600px;"></span>
        </p>
    </div>
  </div>
</div>
<% content_for :sidebar, render(:partial => 'sidebar') -%>

